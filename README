See the massive docstring for more information. No tests yet, sorry :(
